# Environment Variables for LeetGaming PRO Backend (replay-api)

# =============================================================================
# Database Configuration
# =============================================================================
MONGO_URI=mongodb://host.docker.internal:37019
MONGO_DB_NAME=replay
POSTGRES_HOST=postgres-service
POSTGRES_PORT=5432
POSTGRES_DB=leetgaming
POSTGRES_USER=leetgaming
POSTGRES_PASSWORD=your_postgres_password_here
REDIS_URL=redis://redis-service:6379

# =============================================================================
# AWS/S3 Configuration
# =============================================================================
AWS_ENDPOINT=localstack
AWS_ACCESS_KEY_ID=access_key
AWS_SECRET_ACCESS_KEY=secret_key
AWS_DEFAULT_REGION=us-east-1
S3_ENDPOINT_URL=http://localstack-s3:4566
S3_BUCKET_NAME=localstack-bucket
S3_BUCKET_REGION=us-east-1
S3_BUCKET_ACL=private
S3_BUCKET_ENCRYPTION=aws:kms
S3_BUCKET_KMS_KEY_ID=arn:aws:kms:us-east-1:000000000000:key/00000000-0000-0000-0000-000000000000
S3_BUCKET_VERSIONING=enabled
S3_BUCKET_LIFECYCLE_RULE_ENABLED=true
S3_BUCKET_LIFECYCLE_RULE_PREFIX=logs/
S3_BUCKET_LIFECYCLE_RULE_EXPIRATION_DAYS=30

# =============================================================================
# Kafka Configuration
# =============================================================================
KAFKA_BOOTSTRAP=kafka-1:29092,kafka-2:39092
KAFKA_VERSION=3.6.0
KAFKA_CONSUMER_GROUP_ID=test-group
KAFKA_PARTITION_ASSIGNMENT_STRATEGY=range

# =============================================================================
# API Configuration
# =============================================================================
DEV_ENV="true"
REPLAY_API_PORT=8080
REPLAY_API_URL=http://replay-api-service:8080
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# Authentication
# =============================================================================
#
# IMPORTANT: These values MUST match the frontend (.env.local) for auth to work!
# Run 'make env-check' from project root to auto-sync and validate these values.
#
# -----------------------------------------------------------------------------
# Steam Authentication
# -----------------------------------------------------------------------------
# Get your Steam API Key from: https://steamcommunity.com/dev/apikey
# 1. Log in with your Steam account
# 2. Enter domain name (use 'localhost' for development)
# 3. Accept Terms of Use and copy the generated key
#
STEAM_SECRET=your_steam_api_key_here
STEAM_API_KEY=your_steam_api_key_here

# Steam Verification Hash Salt (MUST match frontend!)
# Generate with: openssl rand -hex 32
STEAM_VHASH_SOURCE=your_steam_vhash_salt_here

# -----------------------------------------------------------------------------
# Google OAuth
# -----------------------------------------------------------------------------
# Get credentials from: https://console.cloud.google.com/apis/credentials
# 1. Create/select a project
# 2. Configure OAuth consent screen (External, add your email)
# 3. Create OAuth 2.0 Client ID (Web application)
# 4. Add redirect URIs:
#    - http://localhost:3030/api/auth/callback/google (development)
#    - https://yourdomain.com/api/auth/callback/google (production)
#
GOOGLE_CLIENT_ID=your_google_client_id_here
GOOGLE_CLIENT_SECRET=your_google_client_secret_here

# -----------------------------------------------------------------------------
# NextAuth.js JWT Secret
# -----------------------------------------------------------------------------
# Used to verify JWT tokens from the frontend (MUST match frontend!)
# Generate with: openssl rand -base64 32
# Docs: https://next-auth.js.org/configuration/options#secret
#
NEXTAUTH_SECRET=your_nextauth_secret_here

# =============================================================================
# AI Provider Configuration (Hybrid Fallback Chain)
# =============================================================================
# GitHub Models API (Primary - Free Tier)
GITHUB_MODELS_API_KEY=your_github_models_key_here
GITHUB_MODELS_API_URL=https://models.inference.ai.azure.com

# Anthropic Claude API (Secondary Fallback)
ANTHROPIC_API_KEY=your_anthropic_key_here
ANTHROPIC_API_URL=https://api.anthropic.com/v1

# OpenAI API (Tertiary Fallback)
OPENAI_API_KEY=your_openai_key_here
OPENAI_API_URL=https://api.openai.com/v1

# AI Provider Priority (comma-separated: github,anthropic,openai)
AI_PROVIDER_PRIORITY=github,anthropic,openai
AI_CACHE_TTL_SECONDS=86400  # 24 hours
AI_MAX_RETRIES=3
AI_REQUEST_TIMEOUT_SECONDS=30

# =============================================================================
# EVM Blockchain Configuration (Polygon Mumbai Testnet)
# =============================================================================
EVM_RPC_URL=https://rpc-mumbai.maticvigil.com
EVM_CHAIN_ID=80001
EVM_NETWORK_NAME=polygon-mumbai

# Platform Wallet (Hot Wallet for Gas Fees)
# ⚠️ CRITICAL: NEVER commit real private keys! Use environment-specific secrets
WALLET_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000000
PLATFORM_WALLET_ADDRESS=0x0000000000000000000000000000000000000000

# Stablecoin Contract Addresses (Polygon Mumbai)
USDC_CONTRACT_ADDRESS=0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174
USDT_CONTRACT_ADDRESS=0xc2132D05D31c914a87C6611C10748AEb04B58e8F

# =============================================================================
# Prize Pool Configuration
# =============================================================================
PRIZE_POOL_PLATFORM_CONTRIBUTION=0.50  # $0.50 added to each prize pool
MIN_PRIZE_POOL=1.00
MAX_PRIZE_POOL=1000.00

# Entry Fees by Tier (USD)
ENTRY_FEE_FREE=0.00
ENTRY_FEE_PREMIUM=1.00
ENTRY_FEE_PRO=2.00
ENTRY_FEE_ELITE=5.00

# =============================================================================
# Anti-Fraud Configuration
# =============================================================================
MIN_MATCH_DURATION_SECONDS=300  # 5 minutes minimum
MAX_DAILY_PRIZE_WINNINGS=50.00  # Per user daily cap
ESCROW_PERIOD_HOURS=72          # 72-hour hold for disputes
MIN_MATCHES_FOR_PRIZE=10        # Anti-smurf: must have 10 matches
NEW_ACCOUNT_PRIZE_BLOCK_DAYS=7  # Block prize matches for new accounts (7 days)

# =============================================================================
# Matchmaking Configuration
# =============================================================================
DEFAULT_MMR_RANGE=200            # ±200 MMR for matching
AI_SKILL_ADJUSTMENT_ENABLED=true
LOBBY_READY_CHECK_TIMEOUT_SECONDS=60
MATCH_ACCEPT_TIMEOUT_SECONDS=30
MAX_QUEUE_TIME_SECONDS=600      # 10 minutes max queue time

# =============================================================================
# Redis Cache Configuration
# =============================================================================
REDIS_CACHE_ENABLED=true
REDIS_CACHE_PREFIX=leetgaming:
REDIS_AI_PREDICTION_TTL=86400   # 24 hours
REDIS_POOL_STATS_TTL=5          # 5 seconds

# =============================================================================
# CORS Configuration
# =============================================================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:30300

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10
